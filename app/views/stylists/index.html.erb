<!-- app/views/stylists/index.html.erb -->
<h1>Stylists</h1>

<!-- 検索フォームやフィルタリングフォーム -->
<%= form_with url: stylists_path, method: :get, local: true do |form| %>
  <div class="form-group">
    <%= form.label :search, "Search by name:" %>
    <%= form.text_field :search, value: params[:search], class: "form-control" %>
  </div>
  <div class="form-group">
    <%= form.submit "Search", class: "btn btn-primary" %>
  </div>
<% end %>

<!-- スタイリストの一覧 -->
<% if @stylists.present? %>
  <div class="row">
    <% @stylists.each do |stylist| %>
      <div class="col-md-4 mb-3">
        <div class="card">
          <% if stylist.profile_image.attached? %>
            <%= image_tag stylist.profile_image, class: "card-img-top", alt: "Profile image of #{stylist.name}" %>
          <% else %>
            <%= image_tag 'default_profile_image.jpg', class: "card-img-top", alt: "Default profile image" %>
          <% end %>
          <div class="card-body">
            <h5 class="card-title"><%= link_to stylist.name, stylist_path(stylist) %></h5>
            <p class="card-text"><%= stylist.profile %></p>

            <!-- 平均評価を表示 -->
            <% if stylist.average_rating.present? %>
              <p class="card-text">
                Rating: <%= number_to_percentage(stylist.average_rating * 20, precision: 1) %>%
              </p>
            <% end %>

            <!-- スタイリストのスタイル写真のサムネイルを表示 -->
            <% if stylist.style_photos.any? %>
              <div class="mb-2">
                <%= image_tag stylist.style_photos.first.image.variant(resize_to_limit: [300, 300]), class: "img-thumbnail", alt: "Style photo" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <p>No stylists available.</p>
<% end %>
